/*
 * jQuery Nivo Slider v3.2
 * http://nivo.dev7studios.com
 *
 * Copyright 2012, Dev7studios
 * Free to use and abuse under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 */

(function(e){var t=function(t,n){var r=e.extend({},e.fn.nivoSlider.defaults,n);var i={currentSlide:0,currentImage:"",totalSlides:0,running:false,paused:false,stop:false,controlNavEl:false};var s=e(t);s.data("nivo:vars",i).addClass("nivoSlider");var o=s.children();o.each(function(){var t=e(this),n="";if(!t.is("img")){if(t.is("a")){t.addClass("nivo-imageLink");n=t}t=t.find("img:first")}var r=r===0?t.attr("width"):t.width(),s=s===0?t.attr("height"):t.height();if(n!==""){n.hide()}t.hide();i.totalSlides++});if(r.randomStart){r.startSlide=Math.floor(Math.random()*i.totalSlides)}if(r.startSlide>0){if(r.startSlide>=i.totalSlides){r.startSlide=i.totalSlides-1}i.currentSlide=r.startSlide}i.currentImage=e(o[i.currentSlide]);if(!i.currentImage.is("img")){i.currentImage=i.currentImage.find("img:first")}i.currentImage.is("a")&&i.currentImage.show();var u=e("<img/>").addClass("nivo-main-image");u.attr("src",i.currentImage.attr("src")).show().appendTo(s);e(window).resize(function(){s.children("img").width(s.width());u.attr("src",i.currentImage.attr("src")).stop().height("auto");e(".nivo-slice, .nivo-box").remove()});var a=e("<div/>",{"class":"nivo-caption"});s.append(a);var f=function(t){var n=e(".nivo-caption",s);if(i.currentImage.attr("title")!=""&&i.currentImage.attr("title")!=undefined){var r=i.currentImage.attr("title");if(r.substr(0,1)=="#")r=e(r).html();if(n.is(":visible")){setTimeout(function(){n.html(r)},t.animSpeed)}else{n.html(r).stop().fadeIn(t.animSpeed)}}else{n.stop().fadeOut(t.animSpeed)}};f(r);var l=0;if(!r.manualAdvance&&o.length>1){l=setInterval(function(){v(s,o,r,false)},r.pauseTime)}if(r.directionNav){s.append('<div class="nivo-directionNav"><a class="nivo-prevNav">'+r.prevText+'</a><a class="nivo-nextNav">'+r.nextText+"</a></div>").on("click","a.nivo-prevNav",function(){if(i.running){return false}clearInterval(l);l="";i.currentSlide-=2;v(s,o,r,"prev")}).on("click","a.nivo-nextNav",function(){if(i.running){return false}clearInterval(l);l="";v(s,o,r,"next")})}if(r.controlNav){i.controlNavEl=e('<div class="nivo-controlNav"></div>');s.after(i.controlNavEl);for(var c=0;c<o.length;c++){if(r.controlNavThumbs){i.controlNavEl.addClass("nivo-thumbs-enabled");var h=o.eq(c);if(!h.is("img")){h=h.find("img:first")}if(h.attr("data-thumb")){i.controlNavEl.append('<a class="nivo-control" rel="'+c+'"><img src="'+h.attr("data-thumb")+'" alt="" /></a>')}}else{i.controlNavEl.append('<a class="nivo-control" rel="'+c+'">'+(c+1)+"</a>")}}e("a:eq("+i.currentSlide+")",i.controlNavEl).addClass("active");e("a",i.controlNavEl).bind("click",function(){if(i.running||e(this).hasClass("active"))return false;clearInterval(l);l="";u.attr("src",i.currentImage.attr("src"));i.currentSlide=e(this).attr("rel")-1;v(s,o,r,"control")})}if(r.pauseOnHover){s.hover(function(){i.paused=true;clearInterval(l);l=""},function(){i.paused=false;if(l===""&&!r.manualAdvance){l=setInterval(function(){v(s,o,r,false)},r.pauseTime)}})}s.bind("nivo:animFinished",function(){u.attr("src",i.currentImage.attr("src"));i.running=false;e(o).each(function(){if(e(this).is("a")){e(this).hide()}});if(e(o[i.currentSlide]).is("a")){e(o[i.currentSlide]).show()}if(l===""&&!i.paused&&!r.manualAdvance){l=setInterval(function(){v(slider,o,r,false)},r.pauseTime)}r.afterChange.call(this)});var p=function(t,n,r){var i=e(r.currentImage).parent();if(i.is("a")){i.show()}e('img[src="'+r.currentImage.attr("src")+'"]',t).not(".nivo-main-image,.nivo-control img").width(t.width()).css("visibility","hidden").show();var s=e('img[src="'+r.currentImage.attr("src")+'"]',t).not(".nivo-main-image,.nivo-control img").parent().is("a")?e('img[src="'+r.currentImage.attr("src")+'"]',t).not(".nivo-main-image,.nivo-control img").parent().height():e('img[src="'+r.currentImage.attr("src")+'"]',t).not(".nivo-main-image,.nivo-control img").height();for(var o=0;o<n.slices;o++){var a=Math.round(t.width()/n.slices);if(o===n.slices-1){t.append(e('<div class="nivo-slice" name="'+o+'"><img src="'+r.currentImage.attr("src")+'" style="position:absolute; width:'+t.width()+"px; height:auto; display:block !important; top:0; left:-"+(a+o*a-a)+'px;" /></div>').css({left:a*o+"px",width:t.width()-a*o+"px",height:s+"px",opacity:"0",overflow:"hidden"}))}else{t.append(e('<div class="nivo-slice" name="'+o+'"><img src="'+r.currentImage.attr("src")+'" style="position:absolute; width:'+t.width()+"px; height:auto; display:block !important; top:0; left:-"+(a+o*a-a)+'px;" /></div>').css({left:a*o+"px",width:a+"px",height:s+"px",opacity:"0",overflow:"hidden"}))}}e(".nivo-slice",t).height(s);u.stop().animate({height:e(r.currentImage).height()},n.animSpeed)};var d=function(t,n,r){if(e(r.currentImage).parent().is("a"))e(r.currentImage).parent().show();e('img[src="'+r.currentImage.attr("src")+'"]',t).not(".nivo-main-image,.nivo-control img").width(t.width()).css("visibility","hidden").show();var i=Math.round(t.width()/n.boxCols),s=Math.round(e('img[src="'+r.currentImage.attr("src")+'"]',t).not(".nivo-main-image,.nivo-control img").height()/n.boxRows);for(var o=0;o<n.boxRows;o++){for(var a=0;a<n.boxCols;a++){if(a===n.boxCols-1){t.append(e('<div class="nivo-box" name="'+a+'" rel="'+o+'"><img src="'+r.currentImage.attr("src")+'" style="position:absolute; width:'+t.width()+"px; height:auto; display:block; top:-"+s*o+"px; left:-"+i*a+'px;" /></div>').css({opacity:0,left:i*a+"px",top:s*o+"px",width:t.width()-i*a+"px"}));e('.nivo-box[name="'+a+'"]',t).height(e('.nivo-box[name="'+a+'"] img',t).height()+"px")}else{t.append(e('<div class="nivo-box" name="'+a+'" rel="'+o+'"><img src="'+r.currentImage.attr("src")+'" style="position:absolute; width:'+t.width()+"px; height:auto; display:block; top:-"+s*o+"px; left:-"+i*a+'px;" /></div>').css({opacity:0,left:i*a+"px",top:s*o+"px",width:i+"px"}));e('.nivo-box[name="'+a+'"]',t).height(e('.nivo-box[name="'+a+'"] img',t).height()+"px")}}}u.stop().animate({height:e(r.currentImage).height()},n.animSpeed)};var v=function(t,n,r,i){var s=t.data("nivo:vars");if(s&&s.currentSlide===s.totalSlides-1){r.lastSlide.call(this)}if((!s||s.stop)&&!i){return false}r.beforeChange.call(this);if(!i){u.attr("src",s.currentImage.attr("src"))}else{if(i==="prev"){u.attr("src",s.currentImage.attr("src"))}if(i==="next"){u.attr("src",s.currentImage.attr("src"))}}s.currentSlide++;if(s.currentSlide===s.totalSlides){s.currentSlide=0;r.slideshowEnd.call(this)}if(s.currentSlide<0){s.currentSlide=s.totalSlides-1}if(e(n[s.currentSlide]).is("img")){s.currentImage=e(n[s.currentSlide])}else{s.currentImage=e(n[s.currentSlide]).find("img:first")}if(r.controlNav){e("a",s.controlNavEl).removeClass("active");e("a:eq("+s.currentSlide+")",s.controlNavEl).addClass("active")}f(r);e(".nivo-slice",t).remove();e(".nivo-box",t).remove();var o=r.effect,a="";if(r.effect==="random"){a=new Array("sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade","boxRandom","boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse");o=a[Math.floor(Math.random()*(a.length+1))];if(o===undefined){o="fade"}}if(r.effect.indexOf(",")!==-1){a=r.effect.split(",");o=a[Math.floor(Math.random()*a.length)];if(o===undefined){o="fade"}}if(s.currentImage.attr("data-transition")){o=s.currentImage.attr("data-transition")}s.running=true;var l=0,c=0,h="",v="",g="";var y=e(".nivo-slice:first",t);if(o==="sliceDown"||o==="sliceDownRight"||o==="sliceDownLeft"){p(t,r,s);l=0;c=0;h=e(".nivo-slice",t);if(o==="sliceDownLeft"){h=e(".nivo-slice",t)._reverse()}h.each(function(){var n=e(this);n.css({top:0});if(c===r.slices-1){setTimeout(function(){n.animate({opacity:1},r.animSpeed,"",function(){t.trigger("nivo:animFinished")})},100+l)}else{setTimeout(function(){n.animate({opacity:1},r.animSpeed)},100+l)}l+=50;c++})}else if(o==="sliceUp"||o==="sliceUpRight"||o==="sliceUpLeft"){p(t,r,s);l=0;c=0;h=e(".nivo-slice",t);if(o==="sliceUpLeft"){h=e(".nivo-slice",t)._reverse()}h.each(function(){var n=e(this);n.css({bottom:0});if(c===r.slices-1){setTimeout(function(){n.animate({opacity:1},r.animSpeed,"",function(){t.trigger("nivo:animFinished")})},100+l)}else{setTimeout(function(){n.animate({opacity:1},r.animSpeed)},100+l)}l+=50;c++})}else if(o==="sliceUpDown"||o==="sliceUpDownRight"||o==="sliceUpDownLeft"){p(t,r,s);l=0;c=0;var b=0;h=e(".nivo-slice",t);if(o==="sliceUpDownLeft"){h=e(".nivo-slice",t)._reverse()}h.each(function(){var n=e(this);if(c===0){n.css(top,0);c++}else{n.css(bottom,0);c=0}if(b===r.slices-1){setTimeout(function(){n.animate({opacity:1},r.animSpeed,"",function(){t.trigger("nivo:animFinished")})},100+l)}else{setTimeout(function(){n.animate({opacity:1},r.animSpeed)},100+l)}l+=50;b++})}else if(o==="fold"){p(t,r,s);l=0;c=0;e(".nivo-slice",t).each(function(){var n=e(this),i=n.width();n.css({top:0,width:0});if(c===r.slices-1){setTimeout(function(){n.animate({width:i,opacity:1},r.animSpeed,"",function(){t.trigger("nivo:animFinished")})},100+l)}else{setTimeout(function(){n.animate({width:i,opacity:1},r.animSpeed)},100+l)}l+=50;c++})}else if(o==="fade"){p(t,r,s);y.css({width:t.width()}).animate({opacity:1},r.animSpeed*2,"",function(){t.trigger("nivo:animFinished")})}else if(o==="slideInRight"){p(t,r,s);y.css({width:0,opacity:1}).animate({width:t.width()},r.animSpeed*2,"",function(){t.trigger("nivo:animFinished")})}else if(o==="slideInLeft"){p(t,r,s);y.css({width:0,opacity:1,left:"",right:0}).animate({width:t.width()},r.animSpeed*2,"",function(){y.css({left:0,right:""});t.trigger("nivo:animFinished")})}else if(o==="boxRandom"){d(t,r,s);v=r.boxCols*r.boxRows;c=0;l=0;g=m(e(".nivo-box",t));g.each(function(){var n=e(this);if(c===v-1){setTimeout(function(){n.animate({opacity:1},r.animSpeed,"",function(){t.trigger("nivo:animFinished")})},100+l)}else{setTimeout(function(){n.animate({opacity:1},r.animSpeed)},100+l)}l+=20;c++})}else if(o==="boxRain"||o==="boxRainReverse"||o==="boxRainGrow"||o==="boxRainGrowReverse"){d(t,r,s);v=r.boxCols*r.boxRows;c=0;l=0;var w=0,E=0,S=[];S[w]=[];g=e(".nivo-box",t);if(o==="boxRainReverse"||o==="boxRainGrowReverse"){g=e(".nivo-box",t)._reverse()}g.each(function(){S[w][E]=e(this);E++;if(E===r.boxCols){w++;E=0;S[w]=[]}});for(var x=0;x<r.boxCols*2;x++){var T=x;for(var N=0;N<r.boxRows;N++){if(T>=0&&T<r.boxCols){(function(n,i,s,u,a){var f=e(S[n][i]),l=f.width(),c=f.height();if(o==="boxRainGrow"||o==="boxRainGrowReverse"){f.width(0).height(0)}if(u===a-1){setTimeout(function(){f.animate({opacity:1,width:l,height:c},r.animSpeed/1.3,"",function(){t.trigger("nivo:animFinished")})},100+s)}else{setTimeout(function(){f.animate({opacity:1,width:l,height:c},r.animSpeed/1.3)},100+s)}})(N,T,l,c,v);c++}T--}l+=100}}};var m=function(e){for(var t,n,r=e.length;r;t=parseInt(Math.random()*r,10),n=e[--r],e[r]=e[t],e[t]=n);return e};var g=function(e){if(this.console&&typeof console.log!=="undefined"){console.log(e)}};var y=e(t).data("nivo:vars").stop;this.stop=function(){if(!y){y=true;g("Stop Slider")}};this.start=function(){if(y){y=false;g("Start Slider")}};r.afterLoad.call(this);return this};e.fn.nivoSlider=function(n){return this.each(function(r,i){var s=e(this);if(s.data("nivoslider")){return s.data("nivoslider")}var o=new t(this,n);s.data("nivoslider",o)})};e.fn.nivoSlider.defaults={effect:"random",slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3e3,startSlide:0,directionNav:true,controlNav:true,controlNavThumbs:false,pauseOnHover:true,manualAdvance:false,prevText:"Prev",nextText:"Next",randomStart:false,beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};e.fn._reverse=[].reverse})(jQuery)
